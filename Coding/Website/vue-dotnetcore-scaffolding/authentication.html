<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue3 + .Net Core3 SPA + Cookie-Based Authentication | VueJCBlog</title>
    <meta name="description" content="A Blog made by Vuepress">
    <link rel="icon" href="/icon.png">
  <link rel="manifest" href="/manifest.webmanifest">
    <meta property="og:site_name" content="VueJCBlog"><meta property="og:title" content="Vue3 + .Net Core3 SPA + Cookie-Based Authentication"><meta property="og:type" content="website"><meta property="og:url" content="/Coding/Website/vue-dotnetcore-scaffolding/authentication.html"><meta name="twitter:title" content="Vue3 + .Net Core3 SPA + Cookie-Based Authentication"><meta name="twitter:url" content="/Coding/Website/vue-dotnetcore-scaffolding/authentication.html"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:label1" content="Written by"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="authentication, 登入, api, app, user, 這邊, cookie, email, public, store, return, session, 實作, claims, based, vue, response, 設定, new, server, csharp, 進行, 處理, weather, axios, 顯示, 認證, getuserinfo, claim, login"><meta property="article:tag" content="authentication"><meta property="article:tag" content="登入"><meta property="article:tag" content="api"><meta property="article:tag" content="app"><meta property="article:tag" content="user"><meta property="article:tag" content="這邊"><meta property="article:tag" content="cookie"><meta property="article:tag" content="email"><meta property="article:tag" content="public"><meta property="article:tag" content="store"><meta property="article:tag" content="return"><meta property="article:tag" content="session"><meta property="article:tag" content="實作"><meta property="article:tag" content="claims"><meta property="article:tag" content="based"><meta property="article:tag" content="vue"><meta property="article:tag" content="response"><meta property="article:tag" content="設定"><meta property="article:tag" content="new"><meta property="article:tag" content="server"><meta property="article:tag" content="csharp"><meta property="article:tag" content="進行"><meta property="article:tag" content="處理"><meta property="article:tag" content="weather"><meta property="article:tag" content="axios"><meta property="article:tag" content="顯示"><meta property="article:tag" content="認證"><meta property="article:tag" content="getuserinfo"><meta property="article:tag" content="claim"><meta property="article:tag" content="login">
    <link rel="preload" href="/assets/css/0.styles.18274374.css" as="style"><link rel="preload" href="/assets/js/app.ae89315e.js" as="script"><link rel="preload" href="/assets/js/layout-Layout.1e3a6301.js" as="script"><link rel="preload" href="/assets/js/page-c405dd3e.b8d8b843.js" as="script"><link rel="prefetch" href="/assets/js/1.666c7553.js"><link rel="prefetch" href="/assets/js/124.dca022f2.js"><link rel="prefetch" href="/assets/js/125.2eda4525.js"><link rel="prefetch" href="/assets/js/126.ddc4b150.js"><link rel="prefetch" href="/assets/js/127.b0cb9c74.js"><link rel="prefetch" href="/assets/js/128.7362fdda.js"><link rel="prefetch" href="/assets/js/129.9db3eacc.js"><link rel="prefetch" href="/assets/js/130.f392865b.js"><link rel="prefetch" href="/assets/js/131.dea36333.js"><link rel="prefetch" href="/assets/js/132.de139573.js"><link rel="prefetch" href="/assets/js/133.b0256384.js"><link rel="prefetch" href="/assets/js/134.c2c9d1b7.js"><link rel="prefetch" href="/assets/js/135.95dafcb8.js"><link rel="prefetch" href="/assets/js/136.88a9d282.js"><link rel="prefetch" href="/assets/js/137.3a2e89e4.js"><link rel="prefetch" href="/assets/js/138.92c7b617.js"><link rel="prefetch" href="/assets/js/139.edba41b3.js"><link rel="prefetch" href="/assets/js/140.99554f2e.js"><link rel="prefetch" href="/assets/js/141.e65f132d.js"><link rel="prefetch" href="/assets/js/142.466361c4.js"><link rel="prefetch" href="/assets/js/143.e9ada836.js"><link rel="prefetch" href="/assets/js/144.3b6ee041.js"><link rel="prefetch" href="/assets/js/145.9ab9cbc2.js"><link rel="prefetch" href="/assets/js/146.b7611974.js"><link rel="prefetch" href="/assets/js/147.4579f0da.js"><link rel="prefetch" href="/assets/js/148.66fae617.js"><link rel="prefetch" href="/assets/js/2.c75f8704.js"><link rel="prefetch" href="/assets/js/3.2283a985.js"><link rel="prefetch" href="/assets/js/4.92687a32.js"><link rel="prefetch" href="/assets/js/5.eb5bc7fd.js"><link rel="prefetch" href="/assets/js/6.234d5839.js"><link rel="prefetch" href="/assets/js/layout-BaseLayout.37ed891a.js"><link rel="prefetch" href="/assets/js/layout-NotFound.8ce2063f.js"><link rel="prefetch" href="/assets/js/page-0193e625.04f722d7.js"><link rel="prefetch" href="/assets/js/page-021b3aa4.9866f57d.js"><link rel="prefetch" href="/assets/js/page-0326a646.fe625464.js"><link rel="prefetch" href="/assets/js/page-0a921c99.812b86f8.js"><link rel="prefetch" href="/assets/js/page-0c6c4d65.ecd6227c.js"><link rel="prefetch" href="/assets/js/page-0c7f77bc.9db22727.js"><link rel="prefetch" href="/assets/js/page-0d32e5ee.86ca8c1f.js"><link rel="prefetch" href="/assets/js/page-0e69d9d2.5c8f0b7a.js"><link rel="prefetch" href="/assets/js/page-1080dbe2.ed828ea2.js"><link rel="prefetch" href="/assets/js/page-11a8df82.bed216f5.js"><link rel="prefetch" href="/assets/js/page-129b7428.ba1652a5.js"><link rel="prefetch" href="/assets/js/page-1486eb54.830df76d.js"><link rel="prefetch" href="/assets/js/page-177d640c.3a331718.js"><link rel="prefetch" href="/assets/js/page-1a34eb5d.9233d98a.js"><link rel="prefetch" href="/assets/js/page-1c4a4e12.b0be3e54.js"><link rel="prefetch" href="/assets/js/page-1ccc22d8.eab99bb0.js"><link rel="prefetch" href="/assets/js/page-1db42de8.412e74a7.js"><link rel="prefetch" href="/assets/js/page-1e536af9.72a44b59.js"><link rel="prefetch" href="/assets/js/page-21fcb945.a6e8c21b.js"><link rel="prefetch" href="/assets/js/page-25bc4f18.a7a178e0.js"><link rel="prefetch" href="/assets/js/page-27f6ecec.228da25c.js"><link rel="prefetch" href="/assets/js/page-29c918e5.e5164c12.js"><link rel="prefetch" href="/assets/js/page-2b10966c.52acc968.js"><link rel="prefetch" href="/assets/js/page-2c6bc4ab.e73724dd.js"><link rel="prefetch" href="/assets/js/page-2e8c0cd0.ee043268.js"><link rel="prefetch" href="/assets/js/page-302e6251.0079db19.js"><link rel="prefetch" href="/assets/js/page-320aac86.77dbaf54.js"><link rel="prefetch" href="/assets/js/page-3229196c.af5ba2e8.js"><link rel="prefetch" href="/assets/js/page-32acecfe.2e0e9c71.js"><link rel="prefetch" href="/assets/js/page-339369e0.3b7c9907.js"><link rel="prefetch" href="/assets/js/page-36d5d2b3.4237b426.js"><link rel="prefetch" href="/assets/js/page-39e05f8b.c6cc9a0d.js"><link rel="prefetch" href="/assets/js/page-3ab0cb1c.6515326f.js"><link rel="prefetch" href="/assets/js/page-3c8dbd4b.78172e74.js"><link rel="prefetch" href="/assets/js/page-3cdc4745.1eb19726.js"><link rel="prefetch" href="/assets/js/page-3cfa4e13.2d1068b2.js"><link rel="prefetch" href="/assets/js/page-3edf90d5.123d2d59.js"><link rel="prefetch" href="/assets/js/page-3ff73aa5.ed1f14e8.js"><link rel="prefetch" href="/assets/js/page-4107293f.a459c51a.js"><link rel="prefetch" href="/assets/js/page-4144513c.67f7af1d.js"><link rel="prefetch" href="/assets/js/page-422a7e52.aad0affb.js"><link rel="prefetch" href="/assets/js/page-445c88ce.2eb9d821.js"><link rel="prefetch" href="/assets/js/page-4478a866.3d0899d7.js"><link rel="prefetch" href="/assets/js/page-455360d1.8dca3eeb.js"><link rel="prefetch" href="/assets/js/page-47f71914.26ad842c.js"><link rel="prefetch" href="/assets/js/page-4829d184.fed2d44c.js"><link rel="prefetch" href="/assets/js/page-486aacae.a60ccb4c.js"><link rel="prefetch" href="/assets/js/page-4d521b14.a0fe5710.js"><link rel="prefetch" href="/assets/js/page-4d7e2aa5.fcbcbc39.js"><link rel="prefetch" href="/assets/js/page-4d9fba32.93396f22.js"><link rel="prefetch" href="/assets/js/page-4dc00f25.e2d0703e.js"><link rel="prefetch" href="/assets/js/page-4dc54ba5.30a25c44.js"><link rel="prefetch" href="/assets/js/page-4df429d2.36d9e0ae.js"><link rel="prefetch" href="/assets/js/page-518ca8d8.48259024.js"><link rel="prefetch" href="/assets/js/page-545b8d99.29747d35.js"><link rel="prefetch" href="/assets/js/page-55a376be.565bedb0.js"><link rel="prefetch" href="/assets/js/page-59cd63bf.2ae54f5b.js"><link rel="prefetch" href="/assets/js/page-5cdb680e.17728988.js"><link rel="prefetch" href="/assets/js/page-5de41bb6.dac59d27.js"><link rel="prefetch" href="/assets/js/page-5edad598.fb21a415.js"><link rel="prefetch" href="/assets/js/page-63d82e5a.c2909264.js"><link rel="prefetch" href="/assets/js/page-64a9a694.1ea1bf8a.js"><link rel="prefetch" href="/assets/js/page-66061c06.2f010cc1.js"><link rel="prefetch" href="/assets/js/page-6890df9a.00ea7e5a.js"><link rel="prefetch" href="/assets/js/page-68b44e7f.9b6ed1e9.js"><link rel="prefetch" href="/assets/js/page-6dbff0ea.a6ffe0b3.js"><link rel="prefetch" href="/assets/js/page-6f7fa8b4.9e64f71f.js"><link rel="prefetch" href="/assets/js/page-70612fe6.c618aaef.js"><link rel="prefetch" href="/assets/js/page-720c8312.880c3d42.js"><link rel="prefetch" href="/assets/js/page-74a44f51.1de6c274.js"><link rel="prefetch" href="/assets/js/page-7507c3f6.4d8d13a9.js"><link rel="prefetch" href="/assets/js/page-761a0ef6.6ba90866.js"><link rel="prefetch" href="/assets/js/page-7690c622.7d1d386c.js"><link rel="prefetch" href="/assets/js/page-777196ab.1e35823e.js"><link rel="prefetch" href="/assets/js/page-793331a0.c441a3b3.js"><link rel="prefetch" href="/assets/js/page-79e60960.2dbe50f5.js"><link rel="prefetch" href="/assets/js/page-7ba2451f.ff6ce230.js"><link rel="prefetch" href="/assets/js/page-7bfb30a6.8ae07e42.js"><link rel="prefetch" href="/assets/js/page-7d3a6963.f9fa4fec.js"><link rel="prefetch" href="/assets/js/page-7e6b5e12.a8f3d031.js"><link rel="prefetch" href="/assets/js/page-7f3fbf36.b6125669.js"><link rel="prefetch" href="/assets/js/page-82c2c642.dc17ca56.js"><link rel="prefetch" href="/assets/js/page-85f4c948.495c8790.js"><link rel="prefetch" href="/assets/js/page-8892394c.3b9a5706.js"><link rel="prefetch" href="/assets/js/page-89b130dc.e34f757d.js"><link rel="prefetch" href="/assets/js/page-8da9df6c.615db201.js"><link rel="prefetch" href="/assets/js/page-916af89c.6e74c626.js"><link rel="prefetch" href="/assets/js/page-9a2a43a4.3b5c0321.js"><link rel="prefetch" href="/assets/js/page-9ec1a766.e652f266.js"><link rel="prefetch" href="/assets/js/page-9f0190e0.3d0ae089.js"><link rel="prefetch" href="/assets/js/page-a6174872.2573b501.js"><link rel="prefetch" href="/assets/js/page-aab392fc.5a1979e0.js"><link rel="prefetch" href="/assets/js/page-ace574d0.94b353fb.js"><link rel="prefetch" href="/assets/js/page-ad24ce34.d2a94978.js"><link rel="prefetch" href="/assets/js/page-b0521034.295c6915.js"><link rel="prefetch" href="/assets/js/page-b0d90ce6.cb238011.js"><link rel="prefetch" href="/assets/js/page-b40de7ce.f2c14681.js"><link rel="prefetch" href="/assets/js/page-c26b0310.d8562950.js"><link rel="prefetch" href="/assets/js/page-c4bdd70e.513ba7cb.js"><link rel="prefetch" href="/assets/js/page-c5f1a60e.4528d108.js"><link rel="prefetch" href="/assets/js/page-c60be50a.cfc52c0e.js"><link rel="prefetch" href="/assets/js/page-d3e58f16.5be9a2fd.js"><link rel="prefetch" href="/assets/js/page-d6c4343e.71921fba.js"><link rel="prefetch" href="/assets/js/page-e468b710.b50cfa1a.js"><link rel="prefetch" href="/assets/js/page-e72e49e8.f9b1e6d4.js"><link rel="prefetch" href="/assets/js/page-ec44d602.41b2d3d6.js"><link rel="prefetch" href="/assets/js/page-ed303fba.a3be7e08.js"><link rel="prefetch" href="/assets/js/page-f313c186.1a62377a.js"><link rel="prefetch" href="/assets/js/page-f6776002.7ccc7618.js"><link rel="prefetch" href="/assets/js/page-fe61e53c.235c57f5.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.404209b1.js"><link rel="prefetch" href="/assets/js/vendors~layout-Layout.e07c5607.js">
    <link rel="stylesheet" href="/assets/css/0.styles.18274374.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-12c3b9f4 data-v-7bf1726c><!----> <div class="sidebar-content active-display" data-v-12c3b9f4><div class="view-container" data-v-12c3b9f4><!----></div></div> <div class="content view-container disactive-displayer" data-v-12c3b9f4><!----></div> <!----> <div class="content__default" style="display:none;" data-v-12c3b9f4><p>承接上篇提到建立一個簡易的<a href="/Coding/Website/vue-dotnetcore-scaffolding/basic.html">Vue3.0 + .net core3.0 Template</a></p> <p>其實Microsoft提供的SPA Template中，是有包含authentication，登入認證這塊的</p> <p>但一樣，就是沒有Vue的版本 (༎ຶ L_ ༎ຶ )</p> <p>那說到 Authentication 這塊，其實實作方式滿多種的:</p> <ul><li><p><strong>Cookie-Based</strong></p> <p>算是比較傳統的方式，好實作，前端cookie存個session id，後端session進行一些資料的紀錄</p></li> <li><p><strong>Token-Based</strong></p> <p>簡單來說，利用JWT，做到類似發號碼牌的方式來實作認證，跟<code>Cookie-Based</code>相比，後端session不用進行身分資料的紀錄</p></li> <li><p><strong>Identity Server</strong></p> <p>Identity Server 是 Microsoft 基於 OAuth 還有 OIDC(Open ID Connection) 規格實作</p> <p>企圖用它來完成各式各樣的認證方式，像是 Facebook 認證、Active Directory 認證</p> <p>API 權限管理、SSO(Single-Sign-Oo) ...，<a href="https://identityserver4.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">相當多的功能<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <p>那這邊將基於 Cookie-Based 來進行 Authentication 的實作</p> <p>Cookie-Based Authentication 算滿好實作的</p> <p>但缺點是 Load Balance 時會需要額外做設定</p> <p>像使用 Session Server 來儲存 Session 裡的資料(Redis Server、DB...)</p> <p>或是 Load Balance 時，讓特定人之Request固定打到某台server ...</p> <h1 id="基本想法">基本想法</h1> <p>關於 Authentication，以下是這次要實作的相關功能說明</p> <ul><li><p><strong>Login</strong></p> <ul><li><p>進行登入認證</p> <ul><li><p>只進行 <code>Email</code> 的檢查:</p> <ul><li><p>輸入空白要顯示錯誤訊息: <code>The Email field is required.</code></p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXsAAACFCAYAAAC60VjWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAA+SSURBVHhe7Z0xixzHEsf1gd5neJlDgfG3cOLMNgiFL3MmsMHIqSNhlCmQMciJswPZYA7h4MITNsips3ndfVVz1TXVM7N7e7cz7t8Pirvd7q6uqq7+73gtuEcDAAD860HsAQA6ALEHAOgAxB4AoAMQewCADkDsAQA6ALEHAOgAxB4AoAMQewCADkDsAQA6ALEHAOgAxB4AoAMQewCADkDsAQA6ALEHAOgAxP4AvvjiCwzbpWWur6+Hr7/+OhzfkuUYc6z//PPP8Mcffwxv377dveU8cj7nBLFfSW5CgL2iIvrTTz8Nf//996Ytx5hjzQJ5dXU1fPjwYfeW88j5nBPEfiWIPewZfWqOxHWLlmPNT8SRcO7Vcj7n5OHE/rdvh//89+O2ff5q+Eum3hd/vfrS7PPb8FXa96vfyotFEHvYM4j9+a0zsf9y+OFPeX12EHvoB8T+/IbYnw3EHvphndi/G55//Gh4/N27YOwA+/358PjR4+H578HYSlsr9lcXL4YXF/v4Xh+xn6AifPNz/Jrnm6zK9XsToZ58VVTvN/s1zp+vhk9n4kPsYc8g9vdlV8PFixfDxVU0VhtiP0EF/XZuEenwPeMv8P/2m7zm20FLzHf20CsPKvYnMMT+9Gzmf9B++uq9TrwR+/IkL5SnbjsnIe+pWBdht2sy7gMAsYdeOVbsXz95NDx6JPbktZlbjz198jT9fDq8zmP2yV5+f/rkcdNPZMeKfXmdxLeY/xC4ujBjFxORbq31e1xfvhle/Hw5XH+4Hi5/vl2zJPg82U+4EeFK2CNhdmJvuXmiV0PsAY4R+3ffJYH++Pnwroy9Hp4moR4/CH404i7r2mJvBF5eP/0xr2vbMWJ/K8J57OaJ+83ltcytn8DLXP+6sbYt9lO/c4bYTzhS7Kv/cpB9eLIHKBwu9tOnfCv+5anePqFb8Q+e7G+/v7/50Di92N88Zd+KuxPl8lR/MVzJWC3S82sR+0O5V7F/P/zweRJ5vsYBCDlc7KeifCv20w+C84v9VHStKNcCnc3On1+L2B/KvYp9LNw3X+cg9gCHiz1P9oj9sTzEk/0o5Imy383XOroOsYdeOVzsT/md/UOIfSzCtwJei3KZ61831t7M1Q8K+Z+yiP0MRnxj0w+CY8Q+czPn1t+3w1uZo75mxb7MbX8YIfawZ44R+2zr/jVOEvPvzv1kb14n8S1m3i9m/jXOm8vLiUi3194I+s3Ym+HyMvkZxf52nf0vg8j6Efudg9jDnlkn9new/KQ//lfA3W2t2B9vWcCTcF9HY/djiP1OQOxhz5xa7MtXPOOTvnyN457872InF/vry+GN+c6+/mrmYQyx3wmIPeyZU4u9fh0zfsVzwqf6bCcX+2TV1zQP/FSfDbHfCYg97JnTi/392n2I/bkNsd8JiD3smdy//KWq8xl/qWpn6NMRhu3NMvwN2vNZzoO/QQsAAPcOYg8A0AGIPQBAByD2AAAdgNgDAHQAYg8A0AGIPQBAByD2AAAdgNgDAHQAYg8A0AGIPQBAByD2AAAdgNgDAHQAYg8A0AGIPQBAByD2AAAdgNgDAHQAYg8A0AGI/YNyPQyfpZJ/tGAXaerF/9LvyU7Oihjy/vfKL/U+Lz9JMX0vLxrkOWN8bv0aFveQujxLvkNk/GX6uUvuM/6l2sEWSCcE50NEK7qA9y32W7qYS0L8Po0dKu6eO4s9tKF2eyCdEJwPxL6A2O8carcH0gnB+Vgh9uVnmqM2ETzxoTYraJkDLqYKZP457pF+fy9jzT1lj3FNsmo/iXnN1zg+/zLPrc/oB4Kaz2+yh4vxWRqbrYvMt2f1zKzPNvsVia43cY7xSz5qUS2qOqTfS75yFpmohmWNzvHx5z3T2Ev163yNeyWb9Jz40vHF2sEWSCcE50MueVPs05i9wEVc0vsjst5esskcj1zUNRdTL/04V/aL3htfB/5ViCuhSa/XiH1m8mTv1k/8SwzWZ7VHMK7C3ayLrNE98ny7fhKjR9ZbUS1ILnZff4baC+p7FH7j6yixd/tkypkbv2tqu1g72ALphOB8yIUbL5KhuqiCF5RyMd1lnfNZkMua54Rm/PmLn4k+TKzwlRjdGt1zFAOJ0ebhhcoyEVK33gtvJqqVzolqqz5Xib3PZw2NNYtnOLfO5BDVcI3YV30SvZewMR5VO9gC6YTgfDQuV6ZcKicClYDJ5Y0uWBa/5sWbWeeJhCgSlUhsMxqv2rin5H0SsZffJzWUPPV9u0e431JdAn9534lQt3DrCzN7jmdoczV40Y1yWiP21m8o5IlSf3n/qNrBFkgnBOdDLtxEqBJrxb4ITmBLorXmYhZBczFEl70SexdX2cfvKXmr0IQCYlgj9i2LxL714bTmQ9KeVTkj2SfbXA7Rel8rbzmWSe6CFeBMVMOjxF72npj4Oap2sAXSCcH5kAt3F7E/+IIdsO4Ysa8ERvF7St4qNKcQ+6iGFrtHuN9SXWS8tY8K5UHrl/bM2FwNvs5RTtUcv3/gNzw7x1G1gy2QTgjOh1y4o8Q+ET5l+UvtOeBi5ot9qNhH4xr3uKcTmlBADLNi38pnZo9Q1GR+sy5LdU3M5tFYv3iG8ruPK+/lxT46q0PEflJnwfbiUbWDLZBOCM6HXJJIQNaIfXTJoktf0RCPiJaAeHGaPNnbGGW//N64TuKOhDhiVuwTOm7r6EW02kNisuN5fvaxSuzl92quxBSdZcGut8i6uTP0+etrK7q+7pM5fn/Zd6ypUPY2fid5iZ+DagdbIJ0QnA9/kQyrxD4jPkZzaybIZa3WONNL60UnEwlzJKzWX86vCIL6kpg1j8inZZK3W58ZxU3M+5vs4epw8L+zD+o4K3Z+vUXyGS04wyq/lEv59/Hpp33CruqexssaneP3D2qoROdXIb50PKpdPm/Ef1OkEwGA3RF+nQLQBrEH2COIPRwIYg+wRxB7OBDEHgCgAxB7AIAOQOwBADoAsQcA6ADEHgCgAxB7AIAOQOwBADoAsQcA6ADEHgCgAxB7AIAOQOwBADoAsQcA6ADEHgCgAxB7AIAOQOwBADoAsQcA6ADEHgCgAxB7AIAOQOwBADrgfGL/LG390YK9vE4Tf7n5/eJm2UlZiqHsf58k/5+ZfcrfFU02R5mj8f1ar1/Dy0/Smu/lRYNcl7k5a3w8CKk3NhFHQFWjFT28u78p63r3vu7p+1TDJb9r5sBWnuylcZ6lhplwz2K/JbFYFHupxV0+hE4h9lthy3Ee+oG4+z8gjthvnVShLYDYFxD7w0DsNwRiv3VShbbAGrGXn2rR3Hz5xzkrLs5asSjNlPxdSFOpZdHVRmvtWcWUrNpP8lbxnhP7ap9seZ5bX3B18vlFImRjzGNLdfE+StzOxxy6Pv8c1wW18zmPfiXvubWW2TNwtETXn43P2a+paqQ9LC8z1fo092VjX0+Vy4r5d+nd2Rx97wU5TvDnlszfY3/mL+W19bs0J9f+WXpP97J7LNXP90p1txJL4xsmRbsFpAnmxN4ejDahbYByCOl9JZrjyWuWhCkzNpfxPx66f8+9rvxLLmOekrc2TInZrJ8g68cGc+sn/hM+Ji/U0Xj2MVcX66PEbC+NxBSepaB7+DrYPfX8fK4+9rk4M4tn4JFxf4mzH10zyTkxW2fxqb3oe3PsL+fT4/fwfiKO7d3FHOU8fO81Y5H5tu4am/rwr9Wn9btmjvZXdIZz9cvjtld0r7XjGydFugWCRhiRw6wOzs1vFd0fjqccfstMo08aLBFdtOqCSNyzMUke6resN804wdfCrS9N7te7NVaEwrqJz7m6WR/hngtEa6raSQy+H5Yu34Q1ZxAwGXd+8riPrYo/YWtUrW/kVmpi1nuO7fGjejexmKPkMfp1NfKUOHx+rhZRLj7WNXOi/lqsX+NcRpbGt0+KfgvMFTJqIje/JTilCYL3laWLokSNEjWvvzAjkoPauKfkoRdmKV71M14wu15+j2poL64VodZ+S3WxPrQ22fxFamHXK1XtfJ6Ky3Ht+RXEp9rcOn+Orf7K5BhGv27NuIfsXepjfzc0e0doxbDUM3fu3USYo+29TCOvCNsz2cp5en9CFf+aOYmov9bUr8xJflr1XBrfOCnyLSCHGAlV2ERu/ngIkc0czFqxOPbC2Eui+1R7uuZdurhai7HZ7Xr5XffzFol96wLYORGTcYlrNFODiMh/VbvozDOS4yFiv3gGEbbObs9MiVV8asz+7KscTT5RL2WifrKUs9I9vc30zLG9u5ij1GXsxdaZKTJffZZ62trK+tGfYv2umZOI+mtt/aq8k3k/S+MbJkW7Beyhe9xBFtz8cpDmwNayRiwyx1yYaE3mvsU+rKHBXoTWfkt1iS7TiMQ4l0e03tauealtvomlOFedQQOdM/HRqHMVf6LKUfIpPuzvBr/es9jjWndjeY9jendVju4sWnkpYX52H+9PqOJfMycR9ddi/QJKzBpfwNL4xkiRbgF76J6oidz8sJES0aFb1lz6zDEXpvyerEJyGfd0zRuuscj6sdnd+jAfN8fWJMpL58/VZamuUW0s0frqDCUG3w8+3qXzW3UGDTSeZ8kqH7K+qlkix2JzrnK0axq55flzNavqY1h1Fi7epd5dlaPrq9YaJYpTY9NaROdZ4jJ+18xZ7C/DUv3uOr4hUoW2QOMCFKImCuaXRkwHqkRN7okaJ+KYC6NrxsuQKDFm0zjdhSnrTQ4TpBajT7dex21dcjNan745fd3K/PTe2gb3/jNLdfUxZPxl1Avsc/Wxz+2z6gxaSC2zVX0ZxKGxZgsFR3zpmM7X1xpnJEYWf1ZRX3qiOeU9t1dV/zU5yhzfe61YfM66Pr+n+0zOy5yBrlszJ+qvzGz9JJ7qrMV32WtpfPukSLdAVEhFClo1UWP+eJHFqjUBfr4334TW3+KF0dfGX463iKO7VNosZb5pxgm+udz6gswZzfmLLoKtQx7Lr6PLongfJSfjY0lIoxh87TJadzV/3na8ddaLZzCD1mXiO6ixxqJnUeUo862fKq4096h/Z59sqceP7d3FHH3vBTl6fJ/ktSWf5FuxZ1rmtOKfmRP1lzJbP8nJjlc9tzS+ogZnJEUGAAD/dhB7AIAOQOwBADoAsQcA6ADEHgCgAxB7AIAOQOwBADoAsQcA6ADEHgCgAxB7AIAOQOwBADoAsQcA6ADEHgCgAxB7AIAOQOwBADoAsQcA6ADEHgCgAxB7AIAOQOwBADoAsQcA6ADEHgCgAxB7AIAOQOwBADoAsQcA6ADEHgCgAxB7AIAOQOwBADoAsQcA6ADEHgCgAxB7AIAOQOwBADoAsQcA6ADEHgDgX88w/B+c3pKUYh/MogAAAABJRU5ErkJggg==" alt="img"></p></li> <li><p>輸入不符合 Email 的格式要顯示: <code>The Email field is not a valid e-mail address.</code></p> <p><img src="data:image/png;base64,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" alt="img"></p></li> <li><p>輸入的 Email 無法通過要顯示: <code>Invalid email</code></p> <p><img src="data:image/png;base64,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" alt="img"></p></li></ul></li></ul></li> <li><p>登入成功要顯示User Name</p> <ul><li><p>一開始要檢查有無登入，有的話要顯示User Name</p> <p><img src="data:image/png;base64,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" alt="img"></p></li></ul></li> <li><p>若登入後，關掉瀏覽器再重新進入頁面不用重新登入</p></li></ul></li> <li><p><strong>Logout</strong></p> <ul><li><p>要顯示請進行登入</p> <p><img src="data:image/png;base64,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" alt="img"></p></li> <li><p>後端Session要清掉</p></li></ul></li> <li><p><strong>API Authorization</strong></p> <ul><li><p>尚未登入就呼叫需授權之API，要顯示401 Unauthorize</p> <p><img src="data:image/png;base64,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" alt="img"></p></li></ul></li></ul> <p>那在這個實作中，為了簡單化實作內容，User的資料用寫死的方式處理</p> <p>所以這邊不會碰到 DB，而認證時，這邊也會先簡單處理</p> <p>不會檢查密碼，只會進行 <code>Email</code> 的比對，唯一可以進行登入的 Email 為 <code>test@auth.com</code></p> <p>而授權API，就用Weather API來進行測試</p> <h1 id="基本處理流程">基本處理流程</h1> <p>從架構上來說，大致處理流程如下</p> <ol><li><p>後端為了啟用 Authentication，必須在<code>Startup.cs</code>裡註冊相關的宣告</p></li> <li><p>建立一個API Controller，用來處理 Authentication API 相關的邏輯</p></li> <li><p>後端建立好 Authentication 機制後，後端就可以使用 <code>[Authorize]</code> Attribute 來管理API的授權</p></li> <li><p>前端建立處理 Authentication 相關API 的來回機制</p></li> <li><p>前端處理登入登出邏輯時，UI要能夠跟著連動</p></li></ol> <h1 id="back-end">Back-End</h1> <h2 id="調整-startup-cs">調整 Startup.cs</h2> <h3 id="開發環境-cors">開發環境 CORS</h3> <p>由於我們需要透過http header中的set-cookie來將session id自動放到cookie中</p> <p>這時若Vue這邊是額外起一個server的話，那就會因為CORS的關係，導致cookie設不了</p> <p>因此這邊我們可以在開發環境中，讓CORS先通過</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Add service and create Policy with options</span>
    services<span class="token punctuation">.</span><span class="token function">AddCors</span><span class="token punctuation">(</span>options <span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IApplicationBuilder</span> app<span class="token punctuation">,</span> <span class="token class-name">IWebHostEnvironment</span> env<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token function">IsDevelopment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Add global cors policy</span>
        app<span class="token punctuation">.</span><span class="token function">UseCors</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x
            <span class="token punctuation">.</span><span class="token function">AllowAnyMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">AllowAnyHeader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">SetIsOriginAllowed</span><span class="token punctuation">(</span>origin <span class="token operator">=&gt;</span> <span class="token keyword">true</span><span class="token punctuation">)</span> <span class="token comment">// allow any origin</span>
            <span class="token punctuation">.</span><span class="token function">AllowCredentials</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// allow credentials</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="設定cookie-based-authentication">設定Cookie-Based Authentication</h3> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Add cookie-based authentication</span>
    services<span class="token punctuation">.</span><span class="token function">AddAuthentication</span><span class="token punctuation">(</span>CookieAuthenticationDefaults<span class="token punctuation">.</span>AuthenticationScheme<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">AddCookie</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>由於預設行為，在未授權的情況下使用API，會把妳導到登入頁</p> <p>這邊我希望他回傳個401 Unauthorized就好，所以上述的Code要再加一些設定</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Add cookie-based authentication</span>
    services<span class="token punctuation">.</span><span class="token function">AddAuthentication</span><span class="token punctuation">(</span>CookieAuthenticationDefaults<span class="token punctuation">.</span>AuthenticationScheme<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">AddCookie</span><span class="token punctuation">(</span>options <span class="token operator">=&gt;</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// Return 401 instead of 302 when accessing resouce without authorization</span>
            <span class="token comment">// (Default behavior will redirect to login url)</span>
            options<span class="token punctuation">.</span>Events<span class="token punctuation">.</span>OnRedirectToLogin <span class="token operator">=</span> context <span class="token operator">=&gt;</span>
            <span class="token punctuation">{</span>
                context<span class="token punctuation">.</span>Response<span class="token punctuation">.</span>StatusCode <span class="token operator">=</span> StatusCodes<span class="token punctuation">.</span>Status401Unauthorized<span class="token punctuation">;</span>
                <span class="token keyword">return</span> Task<span class="token punctuation">.</span>CompletedTask<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>接著調整 Configure</p> <p>這邊要注意順序，<code>app.UseRouting</code>，<code>app.UseAuthentication</code>，<code>app.UseAuthorization</code>，<code>app.UseEndpoints</code></p> <p>這4個的順序是不能顛倒的，不然Compiler不會報錯</p> <p>(然後實際運作時，就會發現Authentication沒作用 lol)</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IApplicationBuilder</span> app<span class="token punctuation">,</span> <span class="token class-name">IWebHostEnvironment</span> env<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Routing</span>
    app<span class="token punctuation">.</span><span class="token function">UseRouting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Authentication</span>
    app<span class="token punctuation">.</span><span class="token function">UseAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    app<span class="token punctuation">.</span><span class="token function">UseAuthorization</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    app<span class="token punctuation">.</span><span class="token function">UseEndpoints</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="設定api-modelstate錯誤訊息的回傳格式">設定API ModelState錯誤訊息的回傳格式</h3> <p>由於預設的訊息很多，而且格式可能會不統一</p> <p>因此這邊做個回傳格式的統一</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token class-name">IServiceCollection</span> services<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    services<span class="token punctuation">.</span><span class="token function">AddControllers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">ConfigureApiBehaviorOptions</span><span class="token punctuation">(</span>options <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">//  Format return message from ModelState</span>
            options<span class="token punctuation">.</span>InvalidModelStateResponseFactory <span class="token operator">=</span> actionContext <span class="token operator">=&gt;</span>
            <span class="token punctuation">{</span>
                <span class="token keyword">var</span> modelState <span class="token operator">=</span> actionContext<span class="token punctuation">.</span>ModelState<span class="token punctuation">.</span>Values<span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">BadRequestObjectResult</span><span class="token punctuation">(</span>actionContext<span class="token punctuation">.</span>ModelState<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>當 <code>ModelState.IsValid == false</code> 時，回傳格式統一為</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;Email&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token string">&quot;The Email field is required.&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;The Email field is not a valid e-mail address.&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="api-controller">API Controller</h2> <p>接著在 <code>Controllers/</code> 下，新增一個 <code>AccountController.cs</code></p> <p>在這邊建立4個API</p> <ol><li>IsLogin: 當網頁第一次進入時，用來判斷user是否還有登入</li> <li>Login: 從前端拿取User輸入的Email，用來做登入的處理</li> <li>Logout: 用來登出，清掉session登入資訊用</li> <li>GetUserInfo: 用來讀取User的資料，像是姓名，當登入成功後，用來顯示在網頁上</li></ol> <h3 id="islogin">IsLogin</h3> <p>這個功能比較單純，Call內建Function即可</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">HttpGet</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">bool</span> <span class="token function">IsLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> 
    <span class="token keyword">return</span> User<span class="token punctuation">.</span>Identity<span class="token punctuation">.</span>IsAuthenticated<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="login">Login</h3> <p>這邊是後端的一個重頭戲</p> <p>基本上在認證登入時，當判斷帳號密碼通過後，妳可能會想存一些user的資訊進session中(就不用一直讀DB)</p> <p>那就可以透過一些內建的物件(Claim)來存一些資訊，像是<code>Email</code>、<code>Name</code>、<code>User Role</code>....等等等</p> <p>這樣就不需要自己宣告很多東西了</p> <p>而設定完User的資訊後，就是設定authentication的一些功能，接著實際呼叫<code>HttpContext.SignInAsync</code>來設定session</p> <p><a href="https://github.com/Jchou24/vue3-donetcore3-spa-cookie-based-auth-template/blob/main/Vue3DonetCore3SPATemplate/Vue3DonetCore3SPATemplate/Controllers/AccountController.cs" target="_blank" rel="noopener noreferrer">完整的code請參考這邊<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>而概略流程的Code如下:</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">HttpPost</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>IActionResult<span class="token operator">&gt;</span> <span class="token function">Login</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token class-name">FromBody</span><span class="token punctuation">]</span> <span class="token class-name">AuthenticationUser</span> authenticationUser<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">var</span> claims <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">List</span><span class="token operator">&lt;</span>Claim<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>
            <span class="token comment">// 設定 User 的一些資訊</span>
            <span class="token keyword">new</span> <span class="token class-name">Claim</span><span class="token punctuation">(</span>ClaimTypes<span class="token punctuation">.</span>Email<span class="token punctuation">,</span> user<span class="token punctuation">.</span>Email<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">Claim</span><span class="token punctuation">(</span>ClaimTypes<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> user<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token keyword">new</span> <span class="token class-name">Claim</span><span class="token punctuation">(</span>ClaimTypes<span class="token punctuation">.</span>Role<span class="token punctuation">,</span> <span class="token string">&quot;Administrator&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> claimsIdentity <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClaimsIdentity</span><span class="token punctuation">(</span>
        claims<span class="token punctuation">,</span> CookieAuthenticationDefaults<span class="token punctuation">.</span>AuthenticationScheme<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 設定 Authentication</span>
    <span class="token keyword">var</span> authProperties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuthenticationProperties</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// AllowRefresh = true,</span>
        <span class="token comment">// Refreshing the authentication session should be allowed.</span>

        <span class="token comment">// ExpiresUtc = DateTimeOffset.UtcNow.AddMinutes(10),</span>
        <span class="token comment">// The time at which the authentication ticket expires. A </span>
        <span class="token comment">// value set here overrides the ExpireTimeSpan option of </span>
        <span class="token comment">// CookieAuthenticationOptions set with AddCookie.</span>

        <span class="token comment">// IsPersistent = true,</span>
        <span class="token comment">// Whether the authentication session is persisted across </span>
        <span class="token comment">// multiple requests. When used with cookies, controls</span>
        <span class="token comment">// whether the cookie's lifetime is absolute (matching the</span>
        <span class="token comment">// lifetime of the authentication ticket) or session-based.</span>

        <span class="token comment">//IssuedUtc = &lt;DateTimeOffset&gt;,</span>
        <span class="token comment">// The time at which the authentication ticket was issued.</span>

        <span class="token comment">//RedirectUri = &lt;string&gt;</span>
        <span class="token comment">// The full path or absolute URI to be used as an http </span>
        <span class="token comment">// redirect response value.</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 將user登入的資訊寫到session中</span>
    <span class="token keyword">await</span> HttpContext<span class="token punctuation">.</span><span class="token function">SignInAsync</span><span class="token punctuation">(</span>
        CookieAuthenticationDefaults<span class="token punctuation">.</span>AuthenticationScheme<span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">ClaimsPrincipal</span><span class="token punctuation">(</span>claimsIdentity<span class="token punctuation">)</span><span class="token punctuation">,</span>
        authProperties<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="logout">Logout</h3> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">HttpPost</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> Task<span class="token operator">&lt;</span>IActionResult<span class="token operator">&gt;</span> <span class="token function">Logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">await</span> HttpContext<span class="token punctuation">.</span><span class="token function">SignOutAsync</span><span class="token punctuation">(</span>CookieAuthenticationDefaults<span class="token punctuation">.</span>AuthenticationScheme<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="getuserinfo">GetUserInfo</h3> <p>這邊使用 <code>[Authorize]</code>，需要登入後才能呼叫此API</p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token punctuation">[</span><span class="token class-name">HttpGet</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token class-name">Authorize</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> <span class="token class-name">UserInfo</span> <span class="token function">GetUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">var</span> userInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span>User<span class="token punctuation">.</span>Claims<span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> userInfo<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// Models/UserInfo.cs</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserInfo</span>
<span class="token punctuation">{</span>
    <span class="token comment">//public List&lt;SimpleClaim&gt; Claims { get; set; } = new List&lt;SimpleClaim&gt;();</span>

    <span class="token keyword">public</span> Dictionary<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token operator">&gt;</span> Claims <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">Dictionary</span><span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">UserInfo</span><span class="token punctuation">(</span>IEnumerable<span class="token operator">&lt;</span>Claim<span class="token operator">&gt;</span> claims<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token keyword">var</span> claim <span class="token keyword">in</span> claims<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">string</span> type <span class="token operator">=</span> claim<span class="token punctuation">.</span>Type<span class="token punctuation">.</span><span class="token function">Split</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Last</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">string</span> <span class="token keyword">value</span> <span class="token operator">=</span> claim<span class="token punctuation">.</span>Value<span class="token punctuation">;</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>Claims<span class="token punctuation">[</span>type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">value</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="authorize-attribute"><code>[Authorize]</code> Attribute</h2> <p>經過上面的設定，現在我們已經可以使用 <code>[Authorize]</code> Attribute</p> <p>接著在 Weather API上，加上 <code>[Authorize]</code></p> <div class="language-csharp extra-class"><pre class="language-csharp"><code><span class="token comment">// Controllers/WeatherForecastController.cs</span>
<span class="token punctuation">[</span><span class="token class-name">HttpGet</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token class-name">Authorize</span><span class="token punctuation">]</span>
<span class="token keyword">public</span> IEnumerable<span class="token operator">&lt;</span>WeatherForecast<span class="token operator">&gt;</span> <span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="front-end">Front-End</h1> <h2 id="vuex-store">Vuex Store</h2> <p>為了要讓登入相關資訊可以 Reactive，這邊使用vuex來儲存一些資訊</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    isAuthenticated<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    claims<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  modules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="authentication-api">Authentication API</h2> <p>這邊將呼叫 Authentication API 的相關function都整理起來</p> <p>像是登入成功後去更新store之類的動作</p> <p>並且設定 <code>axios.defaults.withCredentials = true</code> 來讓 cookie 中的資訊能被自動在http header中帶到後端</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>

axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span>

<span class="token keyword">interface</span> <span class="token class-name">ILogin</span><span class="token punctuation">{</span>
    email<span class="token punctuation">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span> 

<span class="token keyword">function</span> <span class="token function">IsLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_SERVER_URL</span> <span class="token operator">+</span> <span class="token string">'api/account/islogin'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">GetUserInfo</span><span class="token punctuation">(</span><span class="token parameter">store<span class="token punctuation">:</span> any</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_SERVER_URL</span> <span class="token operator">+</span> <span class="token string">'api/account/getuserinfo'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token parameter">response</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>claims <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>claims
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Login</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">:</span> ILogin<span class="token punctuation">,</span> store<span class="token punctuation">:</span> any</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_SERVER_URL</span> <span class="token operator">+</span> <span class="token string">'api/account/login'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>isAuthenticated <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token function">GetUserInfo</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Logout</span><span class="token punctuation">(</span><span class="token parameter">store<span class="token punctuation">:</span> any</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_SERVER_URL</span> <span class="token operator">+</span> <span class="token string">'api/account/logout'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>isAuthenticated <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span>
    ILogin<span class="token punctuation">,</span>
    IsLogin<span class="token punctuation">,</span>
    Login<span class="token punctuation">,</span>
    Logout<span class="token punctuation">,</span>
    GetUserInfo
<span class="token punctuation">}</span>
</code></pre></div><h2 id="authentication-ui">Authentication UI</h2> <h3 id="在nav顯示user-name">在Nav顯示User Name</h3> <p>為了在 Navigation 的UI上，讓右上角的文字可以隨著登入狀態變化而改動</p> <p>這邊將相關邏輯先寫在了 <code>App.vue</code> 上</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent<span class="token punctuation">,</span> computed <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> IsLogin<span class="token punctuation">,</span> GetUserInfo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/api/authentication.ts'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'App'</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">useStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> unauthInfo <span class="token operator">=</span> <span class="token string">&quot;You are not log in&quot;</span>
    <span class="token keyword">const</span> authInfo <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> 
      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hi, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>claims<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">! You are now log in!</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token keyword">const</span> authenticationInfo <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>isAuthenticated <span class="token operator">?</span> authInfo<span class="token punctuation">.</span>value <span class="token punctuation">:</span> unauthInfo
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">IsLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token parameter">response</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>isAuthenticated <span class="token operator">=</span> <span class="token function">Boolean</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>isAuthenticated<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">GetUserInfo</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      authenticationInfo
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h3 id="登入頁">登入頁</h3> <p>登入頁的組件做在 <a href="https://github.com/Jchou24/vue3-donetcore3-spa-cookie-based-auth-template/blob/main/Vue3DonetCore3SPATemplate/Vue3DonetCore3SPATemplate/ClientApp/src/components/TestAuthentication.vue" target="_blank" rel="noopener noreferrer">TestAuthentication.vue<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 上</p> <p>這頁主要要實作的邏輯有:</p> <ul><li>登入</li> <li>登出</li> <li>回寫認證狀態</li></ul> <p>而在登入失敗時，將透過400的status code，來處理從後端帶來的錯誤訊息</p> <h3 id="呼叫-weather-api">呼叫 Weather API</h3> <p>現在我們終於可以來處理 Weather API 了!</p> <p>完整的 code 在 <a href="https://github.com/Jchou24/vue3-donetcore3-spa-cookie-based-auth-template/blob/main/Vue3DonetCore3SPATemplate/Vue3DonetCore3SPATemplate/ClientApp/src/components/TestWeatherAPI.vue" target="_blank" rel="noopener noreferrer">TestWeatherAPI.vue<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>判斷授權的部分，這邊靠401的status code來判斷</p> <p>當有登入時呼叫，可以得到 weather 的資訊</p> <p>而若沒有授權，會出現 401 Unauthorize 的描述</p> <div class="language-js extra-class"><pre class="language-js"><code>axios<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_SERVER_URL</span> <span class="token operator">+</span> <span class="token string">'WeatherForecast'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">response</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  weather<span class="token punctuation">.</span>value <span class="token operator">=</span> response<span class="token punctuation">.</span>data
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>weather<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status<span class="token punctuation">)</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">401</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>
    weather<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&quot;401 Unauthorize, please log in to access Weather API&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="總結來說">總結來說</h1> <p>雖然實作了登入授權的部分，但其實還有許多地方是可以改造的</p> <p>像是連DB拿資料、或授權時用 user role 來進行判斷...</p> <p>但這邊就是簡單實作一個 Cookie-Based Authentication</p> <p><a href="https://github.com/Jchou24/vue3-donetcore3-spa-cookie-based-auth-template" target="_blank" rel="noopener noreferrer">完整的Code在此<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 歡迎參考看看啦</p> <h1 id="reference">Reference</h1> <p><a href="https://docs.microsoft.com/en-us/aspnet/core/security/authentication/cookie?view=aspnetcore-3.1" target="_blank" rel="noopener noreferrer">Use cookie authentication without ASP.NET Core Identity<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://blog.miniasp.com/post/2019/12/25/asp-net-core-3-cookie-based-authentication" target="_blank" rel="noopener noreferrer">如何實作沒有 ASP.NET Core Identity 的 Cookie-based 身分驗證機制<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://blog.miniasp.com/post/2019/12/16/How-to-use-JWT-token-based-auth-in-aspnet-core-31" target="_blank" rel="noopener noreferrer">如何在 ASP.NET Core 3 使用 Token-based 身分驗證與授權 (JWT)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ae89315e.js" defer></script><script src="/assets/js/layout-Layout.1e3a6301.js" defer></script><script src="/assets/js/page-c405dd3e.b8d8b843.js" defer></script>
  </body>
</html>
